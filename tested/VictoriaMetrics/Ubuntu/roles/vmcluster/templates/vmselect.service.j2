[Unit]
Description=VictoriaMetrics Select - Query Node
Documentation=https://docs.victoriametrics.com/Cluster-VictoriaMetrics.html
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
User={{ vm_user }}
Group={{ vm_group }}
WorkingDirectory={{ vm_data_dir }}
ExecStart={{ vm_install_dir }}/vmselect-prod \
  -storageNode={{ vmselect_storage_nodes }} \
  -httpListenAddr={{ vmselect_listen_addr }} \
  -cacheDataSize={{ vmselect_cache_size }} \
  -maxConcurrentInserts={{ vmselect_max_concurrent_inserts }} \
  -loggerLevel={{ vm_log_level }} \
  -loggerStdout \
  -memory.allowedPercent={{ vmselect_memory_allowed_percent | default(60) }}

Restart=on-failure
RestartSec=5
LimitNOFILE=65536
LimitNPROC=32768
MemoryLimit={{ vm_memory_limit }}M

[Install]
WantedBy=multi-user.target